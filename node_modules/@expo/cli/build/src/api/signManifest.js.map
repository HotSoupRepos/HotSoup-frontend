{"version":3,"sources":["../../../src/api/signManifest.ts"],"sourcesContent":["import { ExpoAppManifest, ExpoUpdatesManifest } from '@expo/config';\nimport { JSONObject } from '@expo/json-file';\n\nimport { fetchAsync } from './rest/client';\nimport { ensureLoggedInAsync } from './user/actions';\nimport { getActorDisplayName, getUserAsync } from './user/user';\n\n/** Sign an Expo Updates manifest to access secure features in sandboxed environments like Expo Go. */\nexport async function signExpoGoManifestAsync(manifest: ExpoUpdatesManifest): Promise<string> {\n  await ensureLoggedInAsync();\n  const response = await fetchAsync(`manifest/eas/sign`, {\n    method: 'POST',\n    body: JSON.stringify({\n      manifest,\n    }),\n  });\n  const { data } = await response.json();\n  return data.signature;\n}\n\n/** Sign a classic manifest to access secure features in sandboxed environments like Expo Go. */\nexport async function signClassicExpoGoManifestAsync(\n  manifest: Partial<ExpoAppManifest>\n): Promise<string> {\n  await ensureLoggedInAsync();\n  const res = await fetchAsync('manifest/sign', {\n    method: 'POST',\n    body: JSON.stringify({\n      args: {\n        remoteUsername: manifest.owner ?? getActorDisplayName(await getUserAsync()),\n        remotePackageName: manifest.slug,\n      },\n      manifest: manifest as JSONObject,\n    }),\n  });\n  const { data } = await res.json();\n  return data.response;\n}\n"],"names":["signExpoGoManifestAsync","signClassicExpoGoManifestAsync","manifest","ensureLoggedInAsync","response","fetchAsync","method","body","JSON","stringify","data","json","signature","res","args","remoteUsername","owner","getActorDisplayName","getUserAsync","remotePackageName","slug"],"mappings":"AAAA;;;;QAQsBA,uBAAuB,GAAvBA,uBAAuB;QAavBC,8BAA8B,GAA9BA,8BAA8B;AAlBzB,IAAA,OAAe,WAAf,eAAe,CAAA;AACN,IAAA,QAAgB,WAAhB,gBAAgB,CAAA;AACF,IAAA,KAAa,WAAb,aAAa,CAAA;AAGxD,eAAeD,uBAAuB,CAACE,QAA6B,EAAmB;IAC5F,MAAMC,CAAAA,GAAAA,QAAmB,AAAE,CAAA,oBAAF,EAAE,CAAC;IAC5B,MAAMC,QAAQ,GAAG,MAAMC,CAAAA,GAAAA,OAAU,AAK/B,CAAA,WAL+B,CAAC,CAAC,iBAAiB,CAAC,EAAE;QACrDC,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnBP,QAAQ;SACT,CAAC;KACH,CAAC,AAAC;IACH,MAAM,EAAEQ,IAAI,CAAA,EAAE,GAAG,MAAMN,QAAQ,CAACO,IAAI,EAAE,AAAC;IACvC,OAAOD,IAAI,CAACE,SAAS,CAAC;CACvB;AAGM,eAAeX,8BAA8B,CAClDC,QAAkC,EACjB;IACjB,MAAMC,CAAAA,GAAAA,QAAmB,AAAE,CAAA,oBAAF,EAAE,CAAC;QAKND,MAAc;IAJpC,MAAMW,GAAG,GAAG,MAAMR,CAAAA,GAAAA,OAAU,AAS1B,CAAA,WAT0B,CAAC,eAAe,EAAE;QAC5CC,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnBK,IAAI,EAAE;gBACJC,cAAc,EAAEb,CAAAA,MAAc,GAAdA,QAAQ,CAACc,KAAK,YAAdd,MAAc,GAAIe,CAAAA,GAAAA,KAAmB,AAAsB,CAAA,oBAAtB,CAAC,MAAMC,CAAAA,GAAAA,KAAY,AAAE,CAAA,aAAF,EAAE,CAAC;gBAC3EC,iBAAiB,EAAEjB,QAAQ,CAACkB,IAAI;aACjC;YACDlB,QAAQ,EAAEA,QAAQ;SACnB,CAAC;KACH,CAAC,AAAC;IACH,MAAM,EAAEQ,IAAI,CAAA,EAAE,GAAG,MAAMG,GAAG,CAACF,IAAI,EAAE,AAAC;IAClC,OAAOD,IAAI,CAACN,QAAQ,CAAC;CACtB"}