{"version":3,"sources":["../../../../../src/start/server/middleware/resolveEntryPoint.ts"],"sourcesContent":["import { ProjectConfig } from '@expo/config';\nimport { getEntryPoint } from '@expo/config/paths';\nimport chalk from 'chalk';\nimport path from 'path';\n\nimport { CommandError } from '../../../utils/errors';\n\nconst supportedPlatforms = ['ios', 'android', 'web'];\n\n/** Returns the relative entry file for the project.  */\nexport function resolveEntryPoint(\n  projectRoot: string,\n  platform?: string,\n  projectConfig?: ProjectConfig\n): string {\n  if (platform && !supportedPlatforms.includes(platform)) {\n    throw new CommandError(\n      `Failed to resolve the project's entry file: The platform \"${platform}\" is not supported.`\n    );\n  }\n  // TODO(Bacon): support platform extension resolution like .ios, .native\n  // const platforms = [platform, 'native'].filter(Boolean) as string[];\n  const platforms: string[] = [];\n\n  const entry = getEntryPoint(projectRoot, ['./index'], platforms, projectConfig);\n  if (!entry) {\n    // NOTE(Bacon): I purposefully don't mention all possible resolutions here since the package.json is the most standard and users should opt towards that.\n    throw new CommandError(\n      chalk`The project entry file could not be resolved. Please define it in the {bold package.json} \"main\" field.`\n    );\n  }\n\n  return path.relative(projectRoot, entry);\n}\n"],"names":["resolveEntryPoint","supportedPlatforms","projectRoot","platform","projectConfig","includes","CommandError","platforms","entry","getEntryPoint","chalk","path","relative"],"mappings":"AAAA;;;;QAUgBA,iBAAiB,GAAjBA,iBAAiB;AATH,IAAA,MAAoB,WAApB,oBAAoB,CAAA;AAChC,IAAA,MAAO,kCAAP,OAAO,EAAA;AACR,IAAA,KAAM,kCAAN,MAAM,EAAA;AAEM,IAAA,OAAuB,WAAvB,uBAAuB,CAAA;;;;;;AAEpD,MAAMC,kBAAkB,GAAG;IAAC,KAAK;IAAE,SAAS;IAAE,KAAK;CAAC,AAAC;AAG9C,SAASD,iBAAiB,CAC/BE,WAAmB,EACnBC,QAAiB,EACjBC,aAA6B,EACrB;IACR,IAAID,QAAQ,IAAI,CAACF,kBAAkB,CAACI,QAAQ,CAACF,QAAQ,CAAC,EAAE;QACtD,MAAM,IAAIG,OAAY,aAAA,CACpB,CAAC,0DAA0D,EAAEH,QAAQ,CAAC,mBAAmB,CAAC,CAC3F,CAAC;KACH;IACD,wEAAwE;IACxE,sEAAsE;IACtE,MAAMI,SAAS,GAAa,EAAE,AAAC;IAE/B,MAAMC,KAAK,GAAGC,CAAAA,GAAAA,MAAa,AAAoD,CAAA,cAApD,CAACP,WAAW,EAAE;QAAC,SAAS;KAAC,EAAEK,SAAS,EAAEH,aAAa,CAAC,AAAC;IAChF,IAAI,CAACI,KAAK,EAAE;QACV,yJAAyJ;QACzJ,MAAM,IAAIF,OAAY,aAAA,CACpBI,MAAK,QAAA,CAAC,uGAAuG,CAAC,CAC/G,CAAC;KACH;IAED,OAAOC,KAAI,QAAA,CAACC,QAAQ,CAACV,WAAW,EAAEM,KAAK,CAAC,CAAC;CAC1C"}